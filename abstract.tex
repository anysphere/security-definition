\begin{abstract}
We present a novel, complete definition of metadata-private messaging (MPM), and show that our definition is achievable and non-trivially more general than previous attempts that we are aware of. Our main contributions are:
\begin{enumerate}
    \item We describe a vulnerability in existing MPM implementations through a variation of the compromised-friend (CF) attack proposed by Angel et al. \cite{angel2018cf}. Our attack can compromise the exact metadata of any conversations between honest users.
    \item We present a security definition for MPM systems assuming that some friends may be compromised.
    \item We present a protocol satisfying our security definition based on Anysphere, an MPM system we deployed in practice \cite{whitepaper}.
\end{enumerate}
\end{abstract}
