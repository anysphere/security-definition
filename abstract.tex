\begin{abstract}
In this paper, we define and prove the security of metadata-private messaging (MPM) system. Our main contributions are: (1) We describe a vulnerability of existing MPM implementations through a variation of the compromised-friend (CF) attack proposed by Angel et. al. Our attack can compromise the exact metadata of any conversations between honest users. (2) We present a security definition for MPM systems assuming compromised friends. (3) We present a protocol satisfying our security definition based on Anysphere, an MPM system we deployed in practice.
\end{abstract}
